{"version":3,"file":"page.js","sourceRoot":"","sources":["../../src/core/page.ts"],"names":[],"mappings":";;AAAA,0DAAiD;AAGjD,qEAAgE;AAGhE;IAcI,YAAmB,OAAe,EAAE,MAAY;QAV/B,cAAS,GAAG,IAAI,KAAK,EAAQ,CAAC;QAY3C,mBAAK,CAAC,OAAO,EAAE,SAAS,CAAC,CAAC,cAAc,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,mBAAmB,EAAE,CAAC,CAAC;QACjF,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC;QACxB,IAAI,MAAM;YACN,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC;IAClC,CAAC;IAZD,IAAW,OAAO,KAAa,OAAO,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;IACtD,IAAW,MAAM,KAAW,OAAO,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;IAClD,IAAW,QAAQ,KAA0B,OAAO,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACjF,IAAW,YAAY,KAAuB,OAAO,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC;IAYnE,kBAAkB,CAAC,YAA8B;QAEpD,mBAAK,CAAC,YAAY,EAAE,cAAc,CAAC,CAAC,cAAc,EAAE,CAAC;QACrD,IAAI,CAAC,aAAa,GAAG,YAAY,CAAC;IACtC,CAAC;IAEM,QAAQ,CAAC,SAAe;QAE3B,mBAAK,CAAC,SAAS,EAAE,WAAW,CAAC,CAAC,cAAc,EAAE,CAAC;QAC/C,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;IACnC,CAAC;IAEM,WAAW,CAAC,SAAe;QAE9B,mBAAK,CAAC,SAAS,EAAE,WAAW,CAAC,CAAC,cAAc,EAAE;aACzC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,mBAAmB,CAAC,CAAC;QAEzE,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;IACrC,CAAC;IAEM,YAAY,CAAC,MAAY;QAE5B,IAAI,IAAI,CAAC,OAAO;YAAE,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;QACjD,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;QACtB,IAAI,IAAI,CAAC,OAAO;YAAE,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;IAClD,CAAC;IAEM,oBAAoB,CAAC,SAAoB;QAE5C,IAAI,OAAO,GAAG,IAAI,6CAAoB,CAAC,SAAS,CAAC,CAAC;QAElD,IAAI,cAAc,GAAQ;YACtB,IAAI,EAAE,IAAI,CAAC,WAAW,EAAE;YACxB,SAAS,EAAE,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC;YAC7C,QAAQ,EAAE,IAAI,CAAC,aAAa,CAAC,QAAQ;SACxC,CAAC;QAEF,IAAI,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC;YACzB,cAAc,CAAC,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,oBAAoB,CAAC,SAAS,CAAC,CAAC,CAAC;QAEzF,OAAO,cAAc,CAAC;IAC1B,CAAC;IAGO,WAAW;QAEf,IAAI,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,QAAQ,CAAC;QAC9C,IAAI,CAAC,IAAI,CAAC,OAAO;YACb,OAAO,KAAK,CAAC;QAEjB,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,KAAK,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC;QACpE,IAAI,KAAK,CAAC,UAAU,CAAC,GAAG,CAAC;YACrB,KAAK,GAAG,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;QAE5B,OAAO,KAAK,CAAC;IACjB,CAAC;CACJ;AA/ED,oBA+EC","sourcesContent":["import { given } from \"@nivinjoseph/n-defensive\";\nimport { PageRegistration } from \"./page-registration\";\nimport { Container } from \"@nivinjoseph/n-ject\";\nimport { PageComponentFactory } from \"./page-component-factory\";\n\n\nexport class Page\n{\n    private readonly _segment: string;\n    private _parent: Page;\n    private readonly _children = new Array<Page>();\n    private _registration: PageRegistration;\n\n\n    public get segment(): string { return this._segment; }\n    public get parent(): Page { return this._parent; }\n    public get children(): ReadonlyArray<Page> { return this._children.map(t => t); }\n    public get registration(): PageRegistration { return this._registration; }\n\n\n    public constructor(segment: string, parent: Page)\n    {\n        given(segment, \"segment\").ensureHasValue().ensure(t => !t.isEmptyOrWhiteSpace());\n        this._segment = segment;\n        if (parent)\n            this.changeParent(parent);\n    }\n\n\n    public attachRegistration(registration: PageRegistration)\n    {\n        given(registration, \"registration\").ensureHasValue();\n        this._registration = registration;\n    }\n\n    public addChild(childPage: Page): void\n    {\n        given(childPage, \"childPage\").ensureHasValue();\n        this._children.push(childPage);\n    }\n\n    public removeChild(childPage: Page): void\n    {\n        given(childPage, \"childPage\").ensureHasValue()\n            .ensure(t => this._children.some(u => u === t), \"child not present\");\n\n        this._children.remove(childPage);\n    }\n\n    public changeParent(parent: Page): void\n    {\n        if (this._parent) this._parent.removeChild(this);\n        this._parent = parent;\n        if (this._parent) this._parent.addChild(this);\n    }\n    \n    public createVueRouterRoute(container: Container): any\n    {\n        let factory = new PageComponentFactory(container);\n        \n        let vueRouterRoute: any = {\n            path: this.createRoute(),\n            component: factory.create(this._registration),\n            redirect: this._registration.redirect\n        };\n        \n        if (this._children.length > 0)\n            vueRouterRoute.children = this._children.map(t => t.createVueRouterRoute(container));\n        \n        return vueRouterRoute;\n    }\n    \n    \n    private createRoute(): string\n    {\n        let route = this._registration.route.vueRoute;\n        if (!this._parent)\n            return route;\n        \n        route = route.replace(this._parent.registration.route.vueRoute, \"\");\n        if (route.startsWith(\"/\"))\n            route = route.substr(1);\n        \n        return route;\n    }\n}"]}